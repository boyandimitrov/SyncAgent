[    {
    "es" : "system",
    "bq" : "tenant_objects",
    "mapping" : [
        {
            "bq_column": "id",
            "bq_type": "STRING"
        },
        {
            "bq_column": "name",
            "bq_type": "STRING"
        },
        {
            "bq_column": "type",
            "bq_type": "STRING"
        },
        {
            "bq_column": "timestamp",
            "bq_type": "TIMESTAMP"
        }
    ]
},
{
    "es" : "promoto-country_v2",
    "bq" : "country",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column": "@timestamp",
            "es_type": "date",
            "bq_column": "timestamp",
            "bq_type": "TIMESTAMP"
        },
        {
            "es_column": "native",
            "es_type": "string",
            "bq_column": "native",
            "bq_type": "STRING"
        },
        {
            "es_column": "name",
            "es_type": "string",
            "bq_column": "name",
            "bq_type": "STRING"
        },
        {
            "es_column": "id",
            "es_type": "string",
            "bq_column": "id",
            "bq_type": "STRING"
        }
    ]
},
{
    "es" : "promoto-city_v2",
    "bq" : "city",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column" : "id",
            "es_type" : "string",
            "bq_column" : "id",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "name",
            "es_type" : "string",
            "bq_column" : "name",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "name_bg",
            "es_type" : "string",
            "bq_column" : "name_bg",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "location",
            "es_type" : "object",
            "strategy" : "flat",
            "flatten" : [
                {
                    "es_column" : "lon",
                    "es_type" : "float",
                    "bq_column" : "longitude",
                    "bq_type" : "FLOAT64"
                },
                {
                    "es_column" : "lat",
                    "es_type" : "float",
                    "bq_column" : "latitude",
                    "bq_type" : "FLOAT64"
                }
            ]
        },
        {
            "es_column" : "country",
            "es_type" : "string",
            "bq_column" : "country",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "area",
            "es_type" : "string",
            "bq_column" : "area",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "@timestamp",
            "es_type" : "string",
            "bq_column" : "timestamp",
            "bq_type" : "TIMESTAMP"
        }
    ]
},
{
    "es" : "promoto-user_v2",
    "bq" : "users",
    "sync_batch_size" : 2,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column" : "id",
            "es_type" : "string",
            "bq_column" : "id",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "name",
            "es_type" : "string",
            "bq_column" : "name",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "type",
            "es_type" : "string",
            "bq_column" : "type",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "email",
            "es_type" : "string",
            "bq_column" : "email",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "role",
            "es_type" : "string",
            "bq_column" : "role",
            "bq_type" : "STRING"
        },
        {
            "es_column": "@timestamp",
            "es_type": "date",
            "bq_column": "timestamp",
            "bq_type": "TIMESTAMP"
        }
    ]
},
{
    "es" : "promoto-store_v2",
    "bq" : "store",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column" : "id",
            "es_type" : "string",
            "bq_column" : "id",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "name",
            "es_type" : "string",
            "bq_column" : "name",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "currency",
            "es_type" : "string",
            "bq_column" : "currency",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "vat",
            "es_type" : "int",
            "bq_column" : "vat",
            "bq_type" : "INT64"
        },
        {
            "es_column": "@timestamp",
            "es_type": "date",
            "bq_column": "timestamp",
            "bq_type": "TIMESTAMP"
        },
        {
            "es_column" : "country",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_country",
                    "bq_type" : "string"
                }
            ]
        }
    ]
},
{
    "es" : "promoto-market_v2",
    "bq" : "market",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column" : "id",
            "es_type" : "string",
            "bq_column" : "id",
            "bq_type" : "STRING"
        },
        {
            "es_column": "name",
            "es_type": "string",
            "bq_column": "name",
            "bq_type": "STRING"
        },
        {
            "es_column": "logo",
            "es_type": "string",
            "bq_column": "logo",
            "bq_type": "STRING"
        },
        {
            "es_column": "currency",
            "es_type": "string",
            "bq_column": "currency",
            "bq_type": "STRING"
        },
        {
            "es_column": "vat",
            "es_type": "integer",
            "bq_column": "vat",
            "bq_type": "INT64"
        },
        {
            "es_column" : "identifier",
            "es_type" : "string",
            "bq_column" : "identifier",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "address",
            "es_type" : "string",
            "bq_column" : "address",
            "bq_type" : "STRING"
        },
        {
            "es_column": "headmaster",
            "es_type": "string",
            "bq_column": "headmaster",
            "bq_type": "STRING"
        },
        {
            "es_column" : "city",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_city",
                    "bq_type" : "string"
                }
            ]
        },
        {
            "es_column" : "country",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_country",
                    "bq_type" : "string"
                }
            ]
        },
        {
            "es_column" : "location",
            "es_type" : "object",
            "strategy" : "flat",
            "flatten" : [
                {
                    "es_column" : "lon",
                    "es_type" : "float",
                    "bq_column" : "longitude",
                    "bq_type" : "FLOAT64"
                },
                {
                    "es_column" : "lat",
                    "es_type" : "float",
                    "bq_column" : "latitude",
                    "bq_type" : "FLOAT64"
                }
            ]
        },
        {
            "es_column" : "@timestamp",
            "es_type" : "string",
            "bq_column" : "timestamp",
            "bq_type" : "TIMESTAMP"
        }
    ]
},
{
    "es" : "promoto-distributor_v2",
    "bq" : "distributor",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "mapping" : [
        {
            "es_column" : "id",
            "es_type" : "string",
            "bq_column" : "id",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "country",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_country",
                    "bq_type" : "string"
                }
            ]
        },
        {
            "es_column" : "identifier",
            "es_type" : "string",
            "bq_column" : "identifier",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "address",
            "es_type" : "string",
            "bq_column" : "address",
            "bq_type" : "STRING"
        },
        {
            "es_column" : "city",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_city",
                    "bq_type" : "string"
                }
            ]
        },
        {
            "es_column" : "date_created",
            "es_type" : "string",
            "bq_column" : "date_created",
            "bq_type" : "TIMESTAMP",
            "transfromer" : "string_to_timestamp"
        },
        {
            "es_column": "vat",
            "es_type": "integer",
            "bq_column": "vat",
            "bq_type": "INT64"
        },
        {
            "es_column": "name",
            "es_type": "string",
            "bq_column": "name",
            "bq_type": "STRING"
        },
        {
            "es_column": "logo",
            "es_type": "string",
            "bq_column": "logo",
            "bq_type": "STRING"
        },
        {
            "es_column": "currency",
            "es_type": "string",
            "bq_column": "currency",
            "bq_type": "STRING"
        },
        {
            "es_column" : "location",
            "es_type" : "object",
            "strategy" : "flat",
            "flatten" : [
                {
                    "es_column" : "lon",
                    "es_type" : "float",
                    "bq_column" : "longitude",
                    "bq_type" : "FLOAT64"
                },
                {
                    "es_column" : "lat",
                    "es_type" : "float",
                    "bq_column" : "latitude",
                    "bq_type" : "FLOAT64"
                }
            ]
        },
        {
            "es_column" : "@timestamp",
            "es_type" : "string",
            "bq_column" : "timestamp",
            "bq_type" : "TIMESTAMP"
        }
    ]
},
{
    "es" : "promoto-promotion_v2",
    "bq" : "promotion",
    "sync_batch_size" : 100,
    "id_column" : "id.keyword",
    "sync_id_column" : "id",
    "sync_column" : "@timestamp",
    "bridges" : [
        {
            "bq" : "promotion_store",
            "mapping" : [
                {
                    "bq_column" : "id_promotion",
                    "bq_type" : "STRING"
                },
                {
                    "bq_column" : "id_store",
                    "bq_type" : "STRING"
                }
            ]
        }       
    ],
    "mapping" : [
        {
            "es_column": "id",
            "es_type": "string",
            "bq_column": "id",
            "bq_type": "STRING"
        },
        {
            "es_column": "@timestamp",
            "es_type": "date",
            "bq_column": "timestamp",
            "bq_type": "TIMESTAMP"
        },
        {
            "es_column": "name_bg",
            "es_type": "string",
            "bq_column": "name_bg",
            "bq_type": "STRING"
        },
        {
            "es_column": "identifier",
            "es_type": "string",
            "bq_column": "identifier",
            "bq_type": "STRING"
        },
        {
            "es_column" : "period",
            "es_type" : "object",
            "strategy" : "flat",
            "flatten" : [
                {
                    "es_column" : "from",
                    "es_type" : "timestamp",
                    "bq_column" : "period_from",
                    "bq_type" : "CUSTOM",
                    "derivatives" :[
                        { "suffix" : "master", "bq_type" : "TIMESTAMP" },
                        { "suffix" : "quarter", "bq_type" : "INT64" },
                        { "suffix" : "half",  "bq_type" : "INT64" },
                        { "suffix" : "year", "bq_type" : "INT64" },
                        { "suffix" : "month", "bq_type" : "INT64" },
                        { "suffix" : "date", "bq_type" : "INT64" },
                        { "suffix" : "day", "bq_type" : "INT64" },
                        { "suffix" : "week",  "bq_type" : "INT64" }                    
                    ],
                    "transformer" : "timestamp_to_smartdate"
                },
                {
                    "es_column" : "to",
                    "es_type" : "timestamp",
                    "bq_column" : "period_to",
                    "bq_type" : "CUSTOM",
                    "derivatives" :[
                        { "suffix" : "master", "bq_type" : "TIMESTAMP" },
                        { "suffix" : "quarter", "bq_type" : "INT64" },
                        { "suffix" : "half",  "bq_type" : "INT64" },
                        { "suffix" : "year", "bq_type" : "INT64" },
                        { "suffix" : "month", "bq_type" : "INT64" },
                        { "suffix" : "date", "bq_type" : "INT64" },
                        { "suffix" : "day", "bq_type" : "INT64" },
                        { "suffix" : "week",  "bq_type" : "INT64" }                    
                    ],
                    "transformer" : "timestamp_to_smartdate"
                }
            ]
        },
        {
            "es_column" : "owner",
            "es_type" : "object",
            "strategy" : "foreign_key_simple",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_distributor",
                    "bq_type" : "string"
                }
            ]
        },
        {
            "es_column" : "quantity",
            "es_type" : "object",
            "strategy" : "flat",
            "flatten" : [
                {
                    "es_column" : "value",
                    "es_type" : "int",
                    "bq_column" : "quantity_value",
                    "bq_type" : "INT64"
                },
                {
                    "es_column" : "dimension",
                    "es_type" : "string",
                    "bq_column" : "quantity_dimension",
                    "bq_type" : "STRING"
                }
            ]
        },
        {
            "es_column" : "store",
            "es_type" : "object",
            "strategy" : "foreign_key_bridge",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_bridge" : "promotion_store",
                    "bq_primary" : "id_promotion",
                    "bq_column" : "id_store",
                    "bq_type" : "STRING"
                }
            ]
        },
        {
            "es_column" : "tid",
            "es_type" : "array",
            "strategy" : "foreign_key_value_array",
            "fk" : [
                {
                    "es_column" : "id",
                    "es_type" : "string",
                    "bq_column" : "fk_tenant_info",
                    "bq_type" : "STRING"
                }
            ]

        }
    ]
}

]


